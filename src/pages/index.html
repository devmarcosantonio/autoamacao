<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Automation</title>
</head>
<body>
    <h1>Automação - Fazer LOGIN instagram</h1>

    <input type="text" id="user" placeholder="Usuário">
    <input type="password" id="password" placeholder="Senha">

    <input type="file" id="fileInput">

    <button id="button-cadastrar-usuarios">Cadastrar Usuários</button>

    <script>
        const xlsx = require('xlsx');
        const fs = require('fs');
        const puppeteer = require('puppeteer');

        function lerExcelParaObjeto(caminhoArquivo) {
            // Lê o arquivo Excel
            const workbook = xlsx.readFile(caminhoArquivo);

            // Pega o nome da primeira aba (sheet)
            const nomePrimeiraAba = workbook.SheetNames[0];

            // Pega os dados da primeira aba
            const planilha = workbook.Sheets[nomePrimeiraAba];

            // Converte os dados em um array de objetos
            const dados = xlsx.utils.sheet_to_json(planilha);

            return dados;
        }

        let dadosExcel = [];

        const arquivos = document.getElementById('fileInput').addEventListener('change', function(event) {
            const arquivo = event.target.files[0];
            if (arquivo) {
                const reader = new FileReader();
                reader.onload = function(event) {
                    const arrayBuffer = event.target.result;
                    const workbook = xlsx.read(arrayBuffer, { type: 'array' });
                    const nomePrimeiraAba = workbook.SheetNames[0];
                    const planilha = workbook.Sheets[nomePrimeiraAba];
                    const dados = xlsx.utils.sheet_to_json(planilha);
                    dadosExcel = dados; // Armazena os dados lidos do Excel na variável global
                };
                reader.readAsArrayBuffer(arquivo);
            } else {
                console.log('Nenhum arquivo selecionado.');
            }
        });

        const user = document.getElementById('user');
        const password = document.getElementById('password');

        
        


        const button = document.querySelector('#button-cadastrar-usuarios');

        button.addEventListener('click', function() {
            const usuario = user.value;
            const senha = password.value;
            const fileInput = document.getElementById('fileInput');
            const arquivoSelecionado = fileInput.files[0];

            if (usuario && senha && arquivoSelecionado) {
                
                console.log(dadosExcel, user.value, password.value);
                captureScreenshot()
            } else {
                alert('Por favor, preencha todos os campos e selecione um arquivo.');
            }
        });

    </script>
    
</body>
</html>